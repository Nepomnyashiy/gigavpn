# Проект PoC: High-Performance VPN Service (Anti-DPI)

**Версия документа:** 1.0
**Дата:** 08.12.2025
**Статус:** Готов к реализации
**Ответственный:** DevOps Architect / Lead Go Developer

---

## 1. Резюме проекта (Executive Summary)

Целью данного Proof of Concept (PoC) является создание и тестирование MVP (Minimum Viable Product) отказоустойчивого VPN-сервиса, способного обходить современные системы DPI (Deep Packet Inspection / ТСПУ) на территории РФ.

Ключевая особенность архитектуры — использование языка **Go (Golang)** для бэкенда и ядра системы, что обеспечивает высокую производительность (High Performance), низкое потребление ресурсов и возможность масштабирования до десятков тысяч одновременных соединений на одном узле.

## 2. Бизнес-обоснование и Проблематика

* **Проблема:** Классические VPN-протоколы (OpenVPN, WireGuard) успешно детектируются и блокируются регулятором. Существующие решения часто медленные или ненадежные.
* **Решение:** Внедрение протокола **VLESS + XTLS-Reality**, который маскирует VPN-трафик под обычный HTTPS-запрос к легитимным зарубежным сайтам (Microsoft, Google, Samsung), делая его неотличимым для цензора.
* **Экономическая эффективность:** Использование Go позволяет снизить требования к оборудованию ("железу") в 3-5 раз по сравнению с решениями на Python, что существенно уменьшает операционные расходы (OPEX).

## 3. Техническая Архитектура (Technology Stack)

Мы используем гибридную архитектуру с разделением на Control Plane и Data Plane.

### 3.1. Data Plane (VPN Узел)

* **Ядро:** `Sing-box` или `Xray-core` (Go-based).
* **Протокол:** `VLESS` + `Vision` (flow control) + `REALITY` (TLS obfuscation).
* **Транспорт:** TCP / HTTP/2.
* **ОС:** Linux (Debian 12 Bookworm).
* **Сетевой стек:** Оптимизация ядра Linux (BBR Congestion Control) для минимизации задержек.

### 3.2. Control Plane (Управление)

* **Язык разработки:** **Go 1.22+**.
* **Обоснование выбора Go:**
    * Строгая типизация и компиляция в единый бинарный файл (Zero-dependency deployment).
    * Нативная многопоточность (Goroutines) для обработки тысяч запросов API.
    * Прямая интеграция с библиотеками VPN-ядра (без использования subprocess).

### 3.3. Client Interface

* **Клиент:** Telegram Bot (Python/aiogram) — выступает исключительно как "тонкий клиент" (интерфейс).

## 4. План реализации (Implementation Roadmap)

PoC рассчитан на **3 рабочих дня** и включает следующие этапы:

### Этап I: Инфраструктура (Infrastructure)

1.  **Выбор провайдера:** Аренда VDS в локации с минимальным RTT до Москвы/СПб (Финляндия/Эстония/Нидерланды). Критерий: Network Latency < 40ms.
2.  **Настройка сервера:**
    * Hardening (SSH keys, UFW firewall).
    * Тюнинг `sysctl.conf` (увеличение лимитов открытых файлов, буферов TCP, включение BBR).

### Этап II: Разработка ядра (Go Backend)

1.  Написание микросервиса на Go (`vpn-manager`), реализующего функции:
    * `GenerateUUID()`: Создание уникального идентификатора пользователя.
    * `GetKeyPair()`: Генерация x25519 ключей для Reality.
    * `BuildConfig()`: Формирование JSON-конфигурации для Sing-box.
    * `GetLink()`: Генерация строки подключения `vless://...`.

### Этап III: Развертывание и Тестирование

1.  Запуск сервиса на VDS.
2.  Генерация тестовых ключей для группы из 5 пользователей (разные провайдеры: МТС, Билайн, Мегафон, Ростелеком, WiFi/LTE).
3.  **Стресс-тест:**
    * Потоковое видео 4K (YouTube/Netflix).
    * VoIP звонки (Telegram/WhatsApp) для проверки задержек.
    * Speedtest (Upload/Download).

## 5. Критерии Успеха (KPIs)

Проект считается успешным, если достигнуты следующие показатели:

| Параметр | Целевое значение | Комментарий |
| :--- | :--- | :--- |
| **Доступность (Uptime)** | 100% | Отсутствие разрывов соединения в течение 24 часов теста. |
| **Скорость (Download)** | > 150 Mbps | При канале сервера 1 Gbps. |
| **Задержка (Ping)** | < 60 ms | До серверов Google/Cloudflare. |
| **Обход блокировок** | Успешно | Instagram, YouTube, LinkedIn открываются мгновенно. |
| **Нагрузка на CPU** | < 10% | При активной нагрузке 100 Mbps (доказательство эффективности Go). |

## 6. Ресурсы и Бюджет (PoC Budget)

Для реализации PoC требуются минимальные ресурсы:

* **Серверные мощности:** ~$5-10 (1 месяц аренды VDS).
* **Разработка:** Внутренний ресурс (Архитектор/DevOps).
* **ПО:** Open Source (Лицензии MIT/GNU GPL).

## 7. Риски и Меры (Risk Management)

1.  **Блокировка IP-адреса:** Риск, что IP выданного сервера уже в "черном списке".
    * *Мера:* Предварительная проверка IP через сервисы GlobalCheck перед настройкой.
2.  **Деградация скорости (Шейпинг):** Провайдер может занижать скорость UDP.
    * *Мера:* Использование `FakeTCP` или переключение на TCP-транспорт внутри VLESS.

---

### Приложение А. Техническая спецификация настройки сети (Sysctl)

Критические настройки ядра Linux для High Performance:

```bash
net.core.default_qdisc=fq
net.ipv4.tcp_congestion_control=bbr
net.ipv4.tcp_fastopen=3
net.ipv4.tcp_window_scaling=1
fs.file-max=100000